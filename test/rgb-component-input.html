<!doctype html>

<html>
<head>
  <meta charset="UTF-8">
  <title>rgb-component-input test</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <script src="../../webcomponentsjs/webcomponents-lite.js"></script>
  <script src="../../web-component-tester/browser.js"></script>
  <script src="../../iron-test-helpers/test-helpers.js"></script>
  <script src="../../iron-test-helpers/mock-interactions.js"></script>

  <link rel="import" href="../../polymer/polymer.html">
  <link rel="import" href="../rgb-component-input.html">
</head>
<body>

  <test-fixture id="basic">
    <template>
      <rgb-component-input color="Red" value="128"></rgb-component-input>
    </template>
  </test-fixture>

  <test-fixture id="error">
    <template>
      <rgb-component-input value="foobar" error-message="error"></rgb-component-input>
    </template>
  </test-fixture>

  <test-fixture id="validator">
    <template>
      <rgb-component-input value="jklmnop"></rgb-component-input>
    </template>
  </test-fixture>

  <script>
    suite('basic', function () {

      test('value may be set', function () {
        var input = fixture('basic');
        assert.equal(input.value, 128);
      });

      test('setting value sets the input value', function () {
        var input = fixture('basic');
        input.value = 64;
        assert.equal(
          input.inputElement.value,
          input.value,
          'inputElement.value equals input.value'
        );
      });

      test('error message is displayed', function () {
        var input = fixture('error');
        forceXIfStamp(input);
        var error = Polymer.dom(input.root).querySelector('paper-input-error');
        assert.ok(error, 'paper-input-error exists');
        assert.notEqual(
          getComputedStyle(error).display,
          'none',
          'error is not display:none'
        );
      });

      test('color name may be set', function () {
        var input = fixture('basic');
        assert.equal(input.color, 'Red');
      });

    });

    suite('validation', function () {

      test('validator is used', function () {
        var input = fixture('validator');
        assert.isTrue(input.inputElement.invalid, 'input is invalid');
      });

      test('invalid attribute set if invalid', function() {
        var input = fixture('validator');
        assert.isTrue(input.invalid, 'invalid is true');
      });

      test('invalid attribute not set if not invalid', function() {
        var input = fixture('basic');
        assert.isFalse(input.invalid, 'invalid is false');
      });

      test('invalid attribute changes with value', function() {
        var input = fixture('basic');
        assert.isFalse(input.invalid, 'invalid is false');
        input.value = 'foobar';
        assert.isTrue(input.invalid, 'invalid is true');
        input.value = 123;
        assert.isFalse(input.invalid, 'invalid is false');
      });

    });
  </script>

</body>
</html>

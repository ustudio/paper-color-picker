<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-form-element-behavior/iron-form-element-behavior.html">
<link rel="import" href="../paper-input/paper-input-container.html">
<link rel="import" href="paper-color-picker.html">
<link rel="import" href="paper-color-picker-behavior.html">

<!--
This component contains 3 elements:

 - `<paper-color-circle>` : An element drawing a color space onto a canvas
 - `<paper-color-picker>` : An element containing a material design picker dialog for colors
 - `<paper-color-input>` : An element that displays an input that allows changing of the color through a color picker dialog.

Shape and colour spaces
---
There are three different main configurations all 3 elements allow: `circle`, `square`
 or `huebox`. This is called the `[shape]` of the color circle. Additionally in the case of `circle` and `square` it can
  be specified whether the colours should be generated from the `hsv` or `hsl` colour space.

    <paper-color-input shape="square" type="hsl"></paper-color-input>


@demo demo/index.html
-->

<dom-module id="paper-color-input">
  <template>
    <style>
      #color-preview {
        height: 16px;
        width: 16px;
        border: 1px solid rgba(0, 0, 0, 0.4);
        border-radius: 1px;
        margin: 2px;
        position: relative;
        background-image: linear-gradient(to right, #ffffff 1%, #ffffff 50%, #eee 50%, #eee 100%), linear-gradient(to right, #eee 1%, #eee 50%, #ffffff 50%, #ffffff 100%);
        background-size: 16px 8px,  16px 8px;
        background-repeat: repeat-x, repeat;
      }

      #color {
        position: absolute;
        left: 0;
        top: 0;
        right: 0;
        bottom: 0;
      }

      #input {
        cursor: pointer;
      }

      .description {
        font-size: 11px;
        color: rgba(0, 0, 0, 0.8);
      }
    </style>

    <paper-input-container id="input" always-float-label>

      <label>[[ label ]]</label>

      <div class="paper-input-input">
        <span>[[ title ]]</span>&nbsp;<span
          hidden$="[[ !withDescription ]]" class="description">
          [[ description ]]
        </span>
      </div>

      <div id="color-preview" suffix>
        <div id="color" style$="[[ backgroundStyle ]]"></div>
      </div>

    </paper-input-container>

    <paper-color-picker
      id="picker"
      red="{{ red }}"
      green="{{ green }}"
      blue="{{ blue }}"
      name="{{ name }}"
      shape="{{ shape }}"
      type="{{ type }}"
      hex="{{ hex }}"
      use-hex-as-title="{{ useHexAsTitle }}"
      title="[[ title ]]"
      alpha="{{ alpha }}"
      allow-alpha="{{ allowAlpha }}"
      always-show-alpha="{{ alwaysShowAlpha }}"
      with-backdrop="[[ withBackdrop ]]"></paper-color-picker>

  </template>

  <script>
    Polymer({

      is: 'paper-color-input',

      behaviors: [
        PaperColorPicker.ColorBehavior
      ],

      properties: {
        /**
         * The label for this input.
         */
        label: {
          type: String,
          value: ''
        },

        /**
         * Shape for the color picker: *square*, *circle*, or *huebox*.
         */
        shape: {
          type: String,
          value: 'circle',
          notify: true
        },

        /**
         * Type: *hsv* or *hsl*.
         */
        type: {
          type: String,
          value: 'hsv',
          notify: true
        },

        /**
         * If true, show a slider to adjust transparency in advanced mode.
         */
        showAlpha: {
          type: Boolean,
          value: false
        },

        /**
         * If true, show a description after the title.
         */
        withDescription: {
          type: Boolean,
          value: false
        },

        /**
         * If true, display a backdrop when opening the dialog.
         */
        withBackdrop: {
          type: Boolean,
          value: false
        },

        /**
         * If true, always show the transparency slider, not just
         * when `advanced` mode is enabled.
         */
        alwaysShowAlpha: {
          type: Boolean,
          value: false
        },

        /**
         * If true, use the hex color code as the title,
         * and use the color name as the description. If false,
         * use the color name as the title, and the hex color
         * code as the description.
         */
        useHexAsTitle: {
          type: Boolean,
          value: false
        },

        /**
         * Automatically set. The color name or the hex color
         * code representation. See: `useHexAsTitle`
         */
        title: {
          type: String,
          notify: true,
          computed: '_computeTitle(hex, name, useHexAsTitle)'
        },

        /**
         * Automatically set. The color name or the hex color
         * code representation. See: `useHexAsTitle`
         */
        description: {
          type: String,
          notify: true,
          computed: '_computeDescription(hex, name, useHexAsTitle)'
        }
      },

      listeners: {
        'input.tap': 'openColorPicker'
      },

      /**
       * Open the color picker.
       */
      openColorPicker: function () {
        this.$.picker.open();
      },

      _computeTitle: function (hex, name, useHexAsTitle) {
        return useHexAsTitle ? hex : name;
      },

      _computeDescription: function (hex, name, useHexAsTitle) {
        return useHexAsTitle ? name : hex;
      }

    });
  </script>
</dom-module>
